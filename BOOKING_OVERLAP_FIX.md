# üîß –ó–∞—Ö–∏–∞–ª–≥—ã–Ω –¥–∞–≤—Ö–∞—Ä–¥–∞–ª –∞–ª–¥–∞–∞ –∑–∞—Å–∞—Ö

## ‚ùå –ê—Å—É—É–¥–∞–ª:
–ù–æ–≥–æ–æ–Ω ”©–Ω–≥”©”©—Ä —Ö–∞—Ä—É—É–ª–∂ –±–∞–π–≥–∞–∞ ”©–¥—Ä“Ø“Ø–¥–∏–π–≥ —Å–æ–Ω–≥–æ—Å–æ–Ω —á backend –∞–ª–¥–∞–∞ ”©–≥—á –±–∞–π–Ω–∞:
```
"Yurt is not available for the selected dates"
```

## üéØ –®–∞–ª—Ç–≥–∞–∞–Ω:

### 1. Date Range Logic ”©”©—Ä ”©”©—Ä –±–∞–π–Ω–∞

**Standard hotel logic:**
- Check-in: 2025-10-17 (–•“Ø–Ω 17-–Ω–¥ –∏—Ä–Ω—ç)
- Check-out: 2025-10-20 (–•“Ø–Ω 20-–Ω–¥ —è–≤–Ω–∞)
- **–ó–∞—Ö–∏–∞–ª–∞–≥–¥—Å–∞–Ω ”©–¥—Ä“Ø“Ø–¥:** 17, 18, 19 (20 –±–∏—à!)
- **20-–Ω–¥ —à–∏–Ω—ç —Ö“Ø–Ω check-in —Ö–∏–π–∂ –±–æ–ª–Ω–æ** ‚úÖ

### 2. ”®”©—Ä –∑–∞—Ö–∏–∞–ª–≥–∞ –±–∞–π–∂ –±–æ–ª–æ—Ö

–•—ç—Ä—ç–≤ database –¥—ç—ç—Ä –¥–∞—Ä–∞–∞—Ö –∑–∞—Ö–∏–∞–ª–≥–∞ –±–∞–π–≤–∞–ª:
```json
{
  "yurtId": "6f74c9a7-f197-45dd-a19f-a16b5a46813f",
  "startDate": "2025-10-18T00:00:00.000Z",
  "endDate": "2025-10-20T00:00:00.000Z",
  "status": "PENDING"
}
```

–¢–∞ 2025-10-17 - 2025-10-24 —Å–æ–Ω–≥–æ—Ö “Ø–µ–¥:
- Frontend: 17 –Ω–æ–≥–æ–æ–Ω (–±—É—Å–∞–¥ –∑–∞—Ö–∏–∞–ª–≥–∞–¥ –æ—Ä–æ–æ–≥“Ø–π)
- Backend: **18, 19 –¥–∞–≤—Ö–∞—Ä–¥–∞–∂ –±–∞–π–Ω–∞** ‚ùå

## ‚úÖ –®–∏–π–¥—ç–ª:

### –ê–ª—Ö–∞–º 1: Browser Console —à–∞–ª–≥–∞—Ö

1. F12 –¥–∞—Ä–∂ DevTools –Ω—ç—ç–Ω—ç
2. Console tab —Å–æ–Ω–≥–æ–Ω–æ
3. Camp detail page –¥—ç—ç—Ä –æ—á–æ—Ö–æ–¥:

```javascript
üîç Active bookings for this yurt: [
  {
    id: "...",
    status: "PENDING",
    startDate: "2025-10-18T00:00:00.000Z",
    endDate: "2025-10-20T00:00:00.000Z"
  }
]
üö´ Total disabled dates: 2
üö´ Disabled date ranges: ["2025-10-18", "2025-10-19"]
```

### –ê–ª—Ö–∞–º 2: –û–≥–Ω–æ–æ —Å–æ–Ω–≥–æ—Ö

1. –ò—Ä—ç—Ö ”©–¥”©—Ä: 2025-10-17 (–Ω–æ–≥–æ–æ–Ω) ‚úÖ
2. –ì–∞—Ä–∞—Ö ”©–¥”©—Ä: 2025-10-24 (–Ω–æ–≥–æ–æ–Ω) ‚úÖ
3. "–ó–∞—Ö–∏–∞–ª–∞—Ö" —Ç–æ–≤—á–ª—É—É—Ä –¥–∞—Ä–Ω–∞

Console –¥—ç—ç—Ä:
```javascript
üìÖ Selected range: 2025-10-17 - 2025-10-24
üîç Checking against bookings: [...]
‚ùå Overlap detected with booking: {
  id: "...",
  start: "2025-10-18T00:00:00.000Z",
  end: "2025-10-20T00:00:00.000Z"
}
```

**–¢–∞–π–ª–±–∞—Ä:** –¢–∞–Ω—ã range (17-24) –Ω—å –æ–¥–æ–æ –±–∞–π–≥–∞–∞ –∑–∞—Ö–∏–∞–ª–≥–∞ (18-20)-—Ç–∞–π –¥–∞–≤—Ö–∞—Ä—á –±–∞–π–Ω–∞!

### –ê–ª—Ö–∞–º 3: –ó”©–≤ –æ–≥–Ω–æ–æ —Å–æ–Ω–≥–æ—Ö

–•–æ—ë—Ä —Å–æ–Ω–≥–æ–ª—Ç –±–∞–π–Ω–∞:

#### –°–æ–Ω–≥–æ–ª—Ç A: ”®–º–Ω”© –Ω—å
- –ò—Ä—ç—Ö ”©–¥”©—Ä: 2025-10-15
- –ì–∞—Ä–∞—Ö ”©–¥”©—Ä: 2025-10-18 (—ç—Å–≤—ç–ª —Ç“Ø“Ø–Ω—ç—ç—Å ”©–º–Ω”©)
- ‚úÖ –î–∞–≤—Ö–∞—Ä–¥–∞—Ö–≥“Ø–π

#### –°–æ–Ω–≥–æ–ª—Ç B: –î–∞—Ä–∞–∞ –Ω—å  
- –ò—Ä—ç—Ö ”©–¥”©—Ä: 2025-10-20 (—ç—Å–≤—ç–ª —Ç“Ø“Ø–Ω—ç—ç—Å —Ö–æ–π—à)
- –ì–∞—Ä–∞—Ö ”©–¥”©—Ä: 2025-10-25
- ‚úÖ –î–∞–≤—Ö–∞—Ä–¥–∞—Ö–≥“Ø–π

## üîç Database —à–∞–ª–≥–∞—Ö

### Prisma Studio –∞—à–∏–≥–ª–∞—Ö:

```bash
cd tusul_back
npx prisma studio
```

1. "Booking" table —Å–æ–Ω–≥–æ–Ω–æ
2. Filter: `yurtId = 6f74c9a7-f197-45dd-a19f-a16b5a46813f`
3. Filter: `status = PENDING` —ç—Å–≤—ç–ª `CONFIRMED`
4. startDate, endDate —à–∞–ª–≥–∞–Ω–∞

### GraphQL –∞—à–∏–≥–ª–∞—Ö:

```bash
# Apollo Studio: http://"http://152.42.163.155:8000/graphql"
```

```graphql
query GetYurtBookings {
  yurt(id: "6f74c9a7-f197-45dd-a19f-a16b5a46813f") {
    id
    name
    bookings {
      id
      startDate
      endDate
      status
    }
  }
}
```

## üìä –î–∞–≤—Ö–∞—Ä–¥–ª—ã–Ω –ª–æ–≥–∏–∫ —Ç–∞–π–ª–±–∞—Ä

### Backend overlap check:

```typescript
OR: [
  {
    // –û–¥–æ–æ –±–∞–π–≥–∞–∞ –∑–∞—Ö–∏–∞–ª–≥–∞ —Ç–∞–Ω—ã —Ö—É–≥–∞—Ü–∞–∞–Ω–¥ —ç—Ö—ç–ª–∂ –±–∞–π–Ω–∞
    startDate: { gte: start, lt: end }
    // –ñ–∏—à—ç—ç: –û–¥–æ–æ –±–∞–π–≥–∞–∞ 18 >= —Ç–∞–Ω—ã 17 AND 18 < —Ç–∞–Ω—ã 24 ‚úÖ
  },
  {
    // –û–¥–æ–æ –±–∞–π–≥–∞–∞ –∑–∞—Ö–∏–∞–ª–≥–∞ —Ç–∞–Ω—ã —Ö—É–≥–∞—Ü–∞–∞–Ω–¥ –¥—É—É—Å—á –±–∞–π–Ω–∞
    endDate: { gt: start, lte: end }
    // –ñ–∏—à—ç—ç: –û–¥–æ–æ –±–∞–π–≥–∞–∞ 20 > —Ç–∞–Ω—ã 17 AND 20 <= —Ç–∞–Ω—ã 24 ‚úÖ
  },
  {
    // –û–¥–æ–æ –±–∞–π–≥–∞–∞ –∑–∞—Ö–∏–∞–ª–≥–∞ —Ç–∞–Ω—ã —Ö—É–≥–∞—Ü–∞–∞–≥ –±“Ø—Ö—ç–ª–¥ –Ω—å –±–∞–≥—Ç–∞–∞–∂ –±–∞–π–Ω–∞
    AND: [
      { startDate: { lte: start } },
      { endDate: { gte: end } }
    ]
  }
]
```

### –ñ–∏—à—ç—ç:

| –¢–∞–Ω—ã range | –û–¥–æ–æ –±–∞–π–≥–∞–∞ –∑–∞—Ö–∏–∞–ª–≥–∞ | –î–∞–≤—Ö–∞—Ä–¥–∞—Ö —ç—Å—ç—Ö | –®–∞–ª—Ç–≥–∞–∞–Ω |
|-----------|---------------------|---------------|----------|
| 17 - 24 | 18 - 20 | ‚úÖ –î–ê–í–•–ê–†–î–ê–ù–ê | 18, 19 –¥–∞–≤—Ö–∞—Ä–¥–∞–∂ –±–∞–π–Ω–∞ |
| 17 - 18 | 18 - 20 | ‚ùå –î–ê–í–•–ê–†–î–ê–•–ì“Æ–ô | 18 –Ω—å end point (check-out ”©–¥”©—Ä) |
| 20 - 24 | 18 - 20 | ‚ùå –î–ê–í–•–ê–†–î–ê–•–ì“Æ–ô | 20 –Ω—å start point (check-in ”©–¥”©—Ä) |
| 15 - 17 | 18 - 20 | ‚ùå –î–ê–í–•–ê–†–î–ê–•–ì“Æ–ô | –ë“Ø—Ä ”©–º–Ω”© |
| 21 - 25 | 18 - 20 | ‚ùå –î–ê–í–•–ê–†–î–ê–•–ì“Æ–ô | –ë“Ø—Ä –¥–∞—Ä–∞–∞ |

## üé® UI —Å–∞–π–∂—Ä—É—É–ª–∞–ª—Ç

Frontend –æ–¥–æ–æ **—è–≥ backend –ª–æ–≥–∏–∫—Ç–æ–π –∏–∂–∏–ª** overlap checking —Ö–∏–π–∂ –±–∞–π–Ω–∞:

```typescript
const hasOverlap = activeBookings.some((booking: any) => {
  const bookingStart = new Date(booking.startDate);
  const bookingEnd = new Date(booking.endDate);
  
  return (
    (bookingStart >= checkInDate && bookingStart < checkOutDate) ||
    (bookingEnd > checkInDate && bookingEnd <= checkOutDate) ||
    (bookingStart <= checkInDate && bookingEnd >= checkOutDate)
  );
});
```

–≠–Ω—ç –Ω—å backend-–∏–π–Ω GraphQL query-—Ç–∞–π **100% –∏–∂–∏–ª** —é–º!

## üöÄ –¢—É—Ä—à–∏–ª—Ç:

1. ‚úÖ Browser console-–∏–π–≥ –Ω—ç—ç–∂, logs —Ö–∞—Ä–∞—Ö
2. ‚úÖ –ó–∞—Ö–∏–∞–ª–∞–≥–¥—Å–∞–Ω ”©–¥—Ä“Ø“Ø–¥–∏–π–≥ —Ç—ç–º–¥—ç–≥–ª—ç—Ö
3. ‚úÖ –î–∞–≤—Ö–∞—Ä–¥–∞—Ö–≥“Ø–π –æ–≥–Ω–æ–æ range —Å–æ–Ω–≥–æ—Ö
4. ‚úÖ Console –¥—ç—ç—Ä "‚úÖ No overlap detected" –≥—ç—Å—ç–Ω –º—ç–¥—ç—ç–ª—ç–ª —Ö–∞—Ä–∞–≥–¥–∞—Ö —ë—Å—Ç–æ–π
5. ‚úÖ –ó–∞—Ö–∏–∞–ª–≥–∞ –∞–º–∂–∏–ª—Ç—Ç–∞–π “Ø“Ø—Å—ç—Ö —ë—Å—Ç–æ–π

## ‚ö†Ô∏è –ê–Ω—Ö–∞–∞—Ä—É—É–ª–≥–∞:

–•—ç—Ä—ç–≤ —Ç–∞ –Ω–æ–≥–æ–æ–Ω ”©–Ω–≥”©”©—Ä —Ö–∞—Ä–∞–≥–¥–∞–∂ –±–∞–π–≥–∞–∞ ”©–¥—Ä–∏–π–≥ —Å–æ–Ω–≥–æ–∂ –±–∞–π–≥–∞–∞ –±–æ–ª **—Ç—É—Ä—à–∏–∂ “Ø–∑—ç—ç—Ä—ç–π!** 

Frontend –æ–¥–æ–æ:
1. Disabled dates-–∏–π–≥ –∑”©–≤ —Ç–æ–æ—Ü–æ–æ–ª–∂ –±–∞–π–Ω–∞ (check-in - check-out —Ö–æ–æ—Ä–æ–Ω–¥)
2. Overlap-–∏–π–≥ backend –ª–æ–≥–∏–∫—Ç–æ–π –∏–∂–ª—ç—ç—Ä —à–∞–ª–≥–∞–∂ –±–∞–π–Ω–∞
3. –î—ç–ª–≥—ç—Ä—ç–Ω–≥“Ø–π console logs —Ö–∞—Ä—É—É–ª–∂ –±–∞–π–Ω–∞

–•—ç—Ä—ç–≤ –∞—Å—É—É–¥–∞–ª “Ø—Ä–≥—ç–ª–∂–∏–ª–≤—ç–ª:
- Console logs —Ö—É—É–ª–∞–∞–¥ –Ω–∞–¥–∞–¥ –∏–ª–≥—ç—ç–Ω—ç “Ø“Ø
- Database –¥—ç—ç—Ä—Ö –∑–∞—Ö–∏–∞–ª–≥—É—É–¥—ã–Ω –º—ç–¥—ç—ç–ª—ç–ª —Ö—É—É–ª–∞–∞–¥ –∏–ª–≥—ç—ç–Ω—ç “Ø“Ø

---

–ê–º–∂–∏–ª—Ç —Ö“Ø—Å—å–µ! üéâ

